<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">
<head>
<title>Javascript 二维码生成库：QRCode</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<script type="text/javascript" src="Package/jquery.min.js"></script>
<script type="text/javascript" src="Package/qrcode.min.js"></script>
<style type="text/css">
	img{
		z-index: 999;
	}
</style>
</head>
<body>

<div id="qrcode" onclick="download()" style="width: 10px;height: 300px;display: block;"></div>
<div id="qrcodeWord" style="width: 300px;height: 100px;background: #fff;word-break: break-all;"></div>
<script type="text/javascript">
document.getElementById("qrcodeWord").innerText  = document.location.href; 
var qrcode = new QRCode(document.getElementById("qrcode"), {
	text: document.location.href,
	width : 300,
	height : 300,
	colorDark : "#000000",
    colorLight : "#fff",
    correctLevel : QRCode.CorrectLevel.H
});

 var canvas=$('canvas')[0];  
 $('#qrcode').attr('src',canvas.toDataURL('image/jpg'))  

function download(){
	var data = $("canvas")[0].toDataURL().replace("image/png", "image/octet-stream;");//获取二维码值，并修改响应头部。　　　
	var filename="blog.png";//保存的图片名称和格式，canvas默认使用的png格式。这个格式效果最好。
	var save_link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
	save_link.href = data;
	save_link.download = filename;
	var event = document.createEvent('MouseEvents');
	event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
	save_link.dispatchEvent(event);
}
</script>	
</body>
</html>
